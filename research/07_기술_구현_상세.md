# 기술 구현 방향

## Google Grounding API

### 개념
AI 모델의 응답을 검증 가능한 정보 소스(실시간 웹 검색)에 연결하는 기술.  
기존 AI의 "할루시네이션" 문제를 해결하고, **실시간 맥락**을 반영한 응답 생성 가능.

### 지원 모델 (2026년 기준)
- Gemini 3 Flash/Pro (Preview)
- Gemini 2.5 Pro/Flash/Flash-Lite
- Gemini 2.0 Flash + Live API

### 운세앱 적용 시나리오

| 시나리오 | Grounding 활용 |
|----------|---------------|
| **날씨 + 사주** | 실시간 날씨 → "오늘 맑음 + 화 기운 → 야외 활동 추천" |
| **뉴스 + 운세** | IT 업계 뉴스 → "AI 발표 + 재성 상승 → 투자 검토" |
| **이벤트 + 여행운** | 축제 정보 → "제주 축제 + 여행운 → 주말 추천" |
| **건강 + 절기** | 절기 정보 → "입춘 + 수 부족 → 검은콩 섭취" |

### 유저 데이터 활용 구조

```
┌──────────────────────────────────────────┐
│  Tier 1: 필수 (회원가입 시)               │
│  • 생년월일시 (사주 계산)                  │
│  • 성별, 양력/음력 선택                   │
├──────────────────────────────────────────┤
│  Tier 2: 권장 (온보딩 선택)               │
│  • 위치 (도시 수준)                       │
│  • 직업/산업 카테고리                     │
│  • 관심사 태그 (최대 5개)                 │
├──────────────────────────────────────────┤
│  Tier 3: 고급 (프리미엄 선택)             │
│  • 정밀 위치, 캘린더 연동                 │
│  • 건강 앱 연동                          │
└──────────────────────────────────────────┘
```

### API 연동 구조 (검증 완료)

```python
from google import genai
from google.genai.types import Tool, GoogleSearch

client = genai.Client()

# Grounding 프롬프트 구성
prompt = f"""
당신은 전문 운세 상담사입니다.

사용자 정보:
- 사주 분석: {saju_analysis}
- 직업: {user_profile['job']}
- 관심사: {user_profile['interests']}
- 현재 위치: 서울

오늘의 운세를 실시간 정보와 결합하여 제공해주세요.
출처를 명시해주세요.
"""

# Grounding 도구 설정
google_search_tool = Tool(google_search=GoogleSearch())

# API 호출
response = client.models.generate_content(
    model="gemini-2.5-flash",
    contents=prompt,
    config={
        "tools": [google_search_tool],
        "tool_config": {
            "retrieval_config": {
                "lat_lng": {
                    "latitude": user_profile["location"]["lat"],
                    "longitude": user_profile["location"]["lng"]
                }
            }
        }
    }
)
```

### 최적화 전략
1. **캐싱**: 공통 정보(날씨, 뉴스) Redis 캐시 (1시간 TTL)
2. **배치 처리**: 아침/저녁 운세 사전 생성
3. **하이브리드**: 정적 정보는 자체 DB, 실시간만 Grounding

---

## 메타버스 기술 스택

### 엔진 비교

| 항목 | Unity | Unreal Engine | WebGL (Three.js) |
|------|-------|---------------|------------------|
| 모바일 최적화 | ⭐⭐⭐⭐⭐ | ⭐⭐⭐ | ⭐⭐⭐ |
| AR 지원 | ⭐⭐⭐⭐⭐ | ⭐⭐⭐ | ⭐⭐ |
| 개발 속도 | ⭐⭐⭐⭐ | ⭐⭐⭐ | ⭐⭐⭐⭐⭐ |
| 앱 크기 | 30-100MB | 100-300MB | 5-20MB (웹) |

### 추천 스택

**Phase 1 (MVP):**
```
React Native 또는 Flutter
+ Three.js (WebView 내 3D)
+ 2D 캐릭터 시스템
```

**Phase 2 (AR):**
```
Unity + AR Foundation
+ Avatar SDK (MetaPerson Creator)
+ ARKit (iOS) + ARCore (Android) 통합
```

**Phase 3 (메타버스):**
```
Unity + Photon/Mirror (멀티플레이어)
+ 실시간 3D 공간
+ VR 지원 (선택적)
```

### AR 프레임워크 선택

| 항목 | ARKit (iOS) | ARCore (Android) | AR Foundation |
|------|-------------|------------------|---------------|
| 지원 기기 | iPhone 6s+ | Android 7.0+ | 양쪽 모두 |
| 평면 감지 | ⭐⭐⭐⭐⭐ | ⭐⭐⭐⭐ | ⭐⭐⭐⭐ |
| 얼굴 추적 | ⭐⭐⭐⭐⭐ | ⭐⭐⭐ | ⭐⭐⭐⭐ |

**결론**: AR Foundation으로 양 플랫폼 통합 개발

### 아바타 SDK

> ⚠️ Ready Player Me 서비스 종료 (2026.01.31)

**선택 대안:**
- **Avatar SDK (MetaPerson Creator)** - 셀카 기반 3D 아바타, Unity 플러그인 지원
- ZEPETO Studio SDK - 아시아 시장 친화적
- 자체 개발 (Three.js / Babylon.js) - 완전 커스텀

---

## 개발 로드맵

### Phase 1: MVP

| 단계 | 핵심 작업 |
|-----|----------|
| 인프라 | GCP 설정, Gemini API 연동, 백엔드 구조 |
| 핵심 기능 | 사주 계산, Grounding 연동, 프롬프트 최적화 |
| UI/UX | 메인 화면, 운세 결과, 2D 아바타 |
| 테스트 | 베타 테스트, 피드백 수집 |

### Phase 2: AR + 소셜

| 단계 | 핵심 작업 |
|-----|----------|
| AR 기반 | Unity 전환, AR Foundation, AR 타로카드 |
| 아바타 | Avatar SDK 연동, 셀카 기반 생성 |
| 소셜 | 친구 시스템, 궁합 기능, 공유 |

### Phase 3: 메타버스

| 단계 | 핵심 작업 |
|-----|----------|
| 공간 | 실시간 3D 점술 공간 |
| 멀티플레이어 | 소셜 상호작용, 그룹 세션 |
| 확장 | AI NPC, 절기 이벤트, VR 지원 |

---

## 프라이버시 & 보안

### 법적 준수
- **한국**: 개인정보보호법, 위치정보법
- **글로벌**: GDPR (유럽), CCPA (미국)

### 기술적 보호
- 저장: AES-256 암호화
- 전송: TLS 1.3
- 분석용 데이터 익명화
- 역할 기반 접근 제어 (RBAC)

### 사용자 신뢰 구축
- 명확한 개인정보처리방침
- 수집 목적 투명하게 설명
- 언제든 데이터 삭제 가능
- 설정에서 공유 범위 조절

---

## 기술 준비 상황 요약

| 영역 | 기술 | 상태 |
|-----|-----|-----|
| AI 엔진 | Gemini + Grounding API | ✅ 연동 검증 완료 |
| 만세력 | 정밀 계산 엔진 | ✅ 분 단위 정확도 |
| 아바타 | Avatar SDK | ✅ 기술 평가 완료 |
| AR | AR Foundation | ✅ 프로토타입 가능 |
| 멀티플레이어 | Photon/Mirror | 📋 검토 중 |

> **핵심 기술은 모두 검증 완료 상태이며, 즉시 개발 착수 가능합니다.**
